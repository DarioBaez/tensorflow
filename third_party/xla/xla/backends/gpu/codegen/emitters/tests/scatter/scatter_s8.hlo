// RUN: test_correctness %s --bijection_inputs=scatter:2

HloModule scatter

reducer {
  old_value = s8[] parameter(0)
  ROOT new_value = s8[] parameter(1)
}

scatter_fusion {
  p0 = s8[16,528,1,256] parameter(0)
  p1 = s32[96,2] parameter(1)
  p2 = s8[16,6,256] parameter(2)
  bitcast = s8[96,1,1,1,256] bitcast(p2)
  ROOT scatter = s8[16,528,1,256] scatter(p0, p1, bitcast),
    update_window_dims={1,2,3,4},
    inserted_window_dims={},
    scatter_dims_to_operand_dims={0,1},
    index_vector_dim=1,
    to_apply=reducer
}
